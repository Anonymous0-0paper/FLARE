#!/bin/bash

#SBATCH --job-name=client-deployment
#SBATCH --output=client-deployment.out
#SBATCH --ntasks={{NTASKS}}
#SBATCH --gpus-per-task=1
#SBATCH --cpus-per-task=2
#SBATCH --time=12:00:00

module load singularity

srun singularity run docker://flwr/supernode:latest \
  --insecure \
  --superlink {{IP}}:9092 \
  --clientappio-api-address 0.0.0.0:$((9094 + SLURM_PROCID)) \
  --node-config "partition-id=$SLURM_PROCID num-partitions={{NTASKS}}"
